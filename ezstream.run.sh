#!/usr/bin/bash

(( EUID == 0 )) &&
  { echo >&2 "This script should not be run as root!"; exit 1; }

# -------------------------------------------------------------------------------------------------------------------- #
# Get options.
# -------------------------------------------------------------------------------------------------------------------- #

OPTIND=1

while getopts "c:h" opt; do
  case ${opt} in
    c)
      config="${OPTARG}"
      ;;
    h|*)
      echo "-c [config.xml]"
      exit 2
      ;;
  esac
done

shift $(( OPTIND - 1 ))

[[ -z "${config}" ]] && exit 1

# -------------------------------------------------------------------------------------------------------------------- #
# -----------------------------------------------------< SCRIPT >----------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

# Get "ezstream".
ezstream=$( command -v ezstream )

# Get "screen".
screen=$( command -v screen )

${screen} -fn -dmS "app.ezstream" "${ezstream}" -c "${config}"

# -------------------------------------------------------------------------------------------------------------------- #
# Exit.
# -------------------------------------------------------------------------------------------------------------------- #

exit 0
